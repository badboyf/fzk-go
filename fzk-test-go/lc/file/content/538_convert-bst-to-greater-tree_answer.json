{
  "data": {
    "solutionArticle": {
      "__typename": "SolutionArticleNode",
      "author": {
        "__typename": "UserNode",
        "profile": {
          "__typename": "UserProfileNode",
          "realName": "åŠ›æ‰£å®˜æ–¹é¢˜è§£",
          "userAvatar": "https://assets.leetcode-cn.com/aliyun-lc-upload/users/leetcode-solution/avatar_1582018938.png",
          "userSlug": "leetcode-solution"
        },
        "username": "LeetCode-Solution"
      },
      "byLeetcode": true,
      "canEdit": false,
      "canEditReward": false,
      "canSee": true,
      "chargeType": "FREE",
      "content": "#### å‰è¨€\n\näºŒå‰æœç´¢æ ‘æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š\n\n1. è‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼›\n   \n2. è‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼›\n   \n3. å®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æœç´¢æ ‘ã€‚\n\nç”±è¿™æ ·çš„æ€§è´¨æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒäºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†æ˜¯ä¸€ä¸ªå•è°ƒé€’å¢çš„æœ‰åºåºåˆ—ã€‚å¦‚æœæˆ‘ä»¬ååºåœ°ä¸­åºéå†è¯¥äºŒå‰æœç´¢æ ‘ï¼Œå³å¯å¾—åˆ°ä¸€ä¸ªå•è°ƒé€’å‡çš„æœ‰åºåºåˆ—ã€‚\n\n#### æ–¹æ³•ä¸€ï¼šååºä¸­åºéå†\n\n**æ€è·¯åŠç®—æ³•**\n\næœ¬é¢˜ä¸­è¦æ±‚æˆ‘ä»¬å°†æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ä¿®æ”¹ä¸ºåŸæ¥çš„èŠ‚ç‚¹å€¼åŠ ä¸Šæ‰€æœ‰å¤§äºå®ƒçš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚è¿™æ ·æˆ‘ä»¬åªéœ€è¦ååºä¸­åºéå†è¯¥äºŒå‰æœç´¢æ ‘ï¼Œè®°å½•è¿‡ç¨‹ä¸­çš„èŠ‚ç‚¹å€¼ä¹‹å’Œï¼Œå¹¶ä¸æ–­æ›´æ–°å½“å‰éå†åˆ°çš„èŠ‚ç‚¹çš„èŠ‚ç‚¹å€¼ï¼Œå³å¯å¾—åˆ°é¢˜ç›®è¦æ±‚çš„ç´¯åŠ æ ‘ã€‚\n\n**ä»£ç **\n\n```C++ [sol1-C++]\nclass Solution {\npublic:\n    int sum = 0;\n\n    TreeNode* convertBST(TreeNode* root) {\n        if (root != nullptr) {\n            convertBST(root->right);\n            sum += root->val;\n            root->val = sum;\n            convertBST(root->left);\n        }\n        return root;\n    }\n};\n```\n\n```Java [sol1-Java]\nclass Solution {\n    int sum = 0;\n\n    public TreeNode convertBST(TreeNode root) {\n        if (root != null) {\n            convertBST(root.right);\n            sum += root.val;\n            root.val = sum;\n            convertBST(root.left);\n        }\n        return root;\n    }\n}\n```\n\n```Python [sol1-Python3]\nclass Solution:\n    def convertBST(self, root: TreeNode) -> TreeNode:\n        def dfs(root: TreeNode):\n            nonlocal total\n            if root:\n                dfs(root.right)\n                total += root.val\n                root.val = total\n                dfs(root.left)\n        \n        total = 0\n        dfs(root)\n        return root\n```\n\n```Golang [sol1-Golang]\nfunc convertBST(root *TreeNode) *TreeNode {\n    sum := 0\n    var dfs func(*TreeNode)\n    dfs = func(node *TreeNode) {\n        if node != nil {\n            dfs(node.Right)\n            sum += node.Val\n            node.Val = sum\n            dfs(node.Left)\n        }\n    }\n    dfs(root)\n    return root\n}\n```\n\n```C [sol1-C]\nint sum;\n\nstruct TreeNode* dfs(struct TreeNode* root) {\n    if (root != NULL) {\n        dfs(root->right);\n        sum += root->val;\n        root->val = sum;\n        dfs(root->left);\n    }\n    return root;\n}\n\nstruct TreeNode* convertBST(struct TreeNode* root) {\n    sum = 0;\n    dfs(root);\n    return root;\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n- æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯äºŒå‰æœç´¢æ ‘çš„èŠ‚ç‚¹æ•°ã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹æ°å¥½è¢«éå†ä¸€æ¬¡ã€‚\n  \n- ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œä¸ºé€’å½’è¿‡ç¨‹ä¸­æ ˆçš„å¼€é”€ï¼Œå¹³å‡æƒ…å†µä¸‹ä¸º $O(\\log n)$ï¼Œæœ€åæƒ…å†µä¸‹æ ‘å‘ˆç°é“¾çŠ¶ï¼Œä¸º $O(n)$ã€‚\n\n#### æ–¹æ³•äºŒï¼šMorris éå†\n\n**æ€è·¯åŠç®—æ³•**\n\næœ‰ä¸€ç§å·§å¦™çš„æ–¹æ³•å¯ä»¥åœ¨çº¿æ€§æ—¶é—´å†…ï¼Œåªå ç”¨å¸¸æ•°ç©ºé—´æ¥å®ç°ä¸­åºéå†ã€‚è¿™ç§æ–¹æ³•ç”± J. H. Morris åœ¨ 1979 å¹´çš„è®ºæ–‡ã€ŒTraversing Binary Trees Simply and Cheaplyã€ä¸­é¦–æ¬¡æå‡ºï¼Œå› æ­¤è¢«ç§°ä¸º Morris éå†ã€‚\n\nMorris éå†çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨æ ‘çš„å¤§é‡ç©ºé—²æŒ‡é’ˆï¼Œå®ç°ç©ºé—´å¼€é”€çš„æé™ç¼©å‡ã€‚å…¶ååºä¸­åºéå†è§„åˆ™æ€»ç»“å¦‚ä¸‹ï¼š\n\n1. å¦‚æœå½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ä¸ºç©ºï¼Œå¤„ç†å½“å‰èŠ‚ç‚¹ï¼Œå¹¶éå†å½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ï¼›\n\n2. å¦‚æœå½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œæ‰¾åˆ°å½“å‰èŠ‚ç‚¹å³å­æ ‘çš„æœ€å·¦èŠ‚ç‚¹ï¼ˆè¯¥èŠ‚ç‚¹ä¸ºå½“å‰èŠ‚ç‚¹ä¸­åºéå†çš„å‰é©±èŠ‚ç‚¹ï¼‰ï¼›\n   \n   - å¦‚æœæœ€å·¦èŠ‚ç‚¹çš„å·¦æŒ‡é’ˆä¸ºç©ºï¼Œå°†æœ€å·¦èŠ‚ç‚¹çš„å·¦æŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹ï¼Œéå†å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹ï¼›\n   \n   - å¦‚æœæœ€å·¦èŠ‚ç‚¹çš„å·¦æŒ‡é’ˆä¸ä¸ºç©ºï¼Œå°†æœ€å·¦èŠ‚ç‚¹çš„å·¦æŒ‡é’ˆé‡æ–°ç½®ä¸ºç©ºï¼ˆæ¢å¤æ ‘çš„åŸçŠ¶ï¼‰ï¼Œå¤„ç†å½“å‰èŠ‚ç‚¹ï¼Œå¹¶å°†å½“å‰èŠ‚ç‚¹ç½®ä¸ºå…¶å·¦èŠ‚ç‚¹ï¼›\n\n3. é‡å¤æ­¥éª¤ 1 å’Œæ­¥éª¤ 2ï¼Œç›´åˆ°éå†ç»“æŸã€‚\n\nè¿™æ ·æˆ‘ä»¬åˆ©ç”¨ Morris éå†çš„æ–¹æ³•ï¼Œååºä¸­åºéå†è¯¥äºŒå‰æœç´¢æ ‘ï¼Œå³å¯å®ç°çº¿æ€§æ—¶é—´ä¸å¸¸æ•°ç©ºé—´çš„éå†ã€‚\n\n**ä»£ç **\n\n```C++ [sol2-C++]\nclass Solution {\npublic:\n    TreeNode* getSuccessor(TreeNode* node) {\n        TreeNode* succ = node->right;\n        while (succ->left != nullptr && succ->left != node) {\n            succ = succ->left;\n        }\n        return succ;\n    }\n\n    TreeNode* convertBST(TreeNode* root) {\n        int sum = 0;\n        TreeNode* node = root;\n\n        while (node != nullptr) {\n            if (node->right == nullptr) {\n                sum += node->val;\n                node->val = sum;\n                node = node->left;\n            } else {\n                TreeNode* succ = getSuccessor(node);\n                if (succ->left == nullptr) {\n                    succ->left = node;\n                    node = node->right;\n                } else {\n                    succ->left = nullptr;\n                    sum += node->val;\n                    node->val = sum;\n                    node = node->left;\n                }\n            }\n        }\n\n        return root;\n    }\n};\n```\n\n```Java [sol2-Java]\nclass Solution {\n    public TreeNode convertBST(TreeNode root) {\n        int sum = 0;\n        TreeNode node = root;\n\n        while (node != null) {\n            if (node.right == null) {\n                sum += node.val;\n                node.val = sum;\n                node = node.left;\n            } else {\n                TreeNode succ = getSuccessor(node);\n                if (succ.left == null) {\n                    succ.left = node;\n                    node = node.right;\n                } else {\n                    succ.left = null;\n                    sum += node.val;\n                    node.val = sum;\n                    node = node.left;\n                }\n            }\n        }\n\n        return root;\n    }\n\n    public TreeNode getSuccessor(TreeNode node) {\n        TreeNode succ = node.right;\n        while (succ.left != null && succ.left != node) {\n            succ = succ.left;\n        }\n        return succ;\n    }\n}\n\n```\n\n```Python [sol2-Python3]\nclass Solution:\n    def convertBST(self, root: TreeNode) -> TreeNode:\n        def getSuccessor(node: TreeNode) -> TreeNode:\n            succ = node.right\n            while succ.left and succ.left != node:\n                succ = succ.left\n            return succ\n        \n        total = 0\n        node = root\n\n        while node:\n            if not node.right:\n                total += node.val\n                node.val = total\n                node = node.left\n            else:\n                succ = getSuccessor(node)\n                if not succ.left:\n                    succ.left = node\n                    node = node.right\n                else:\n                    succ.left = None\n                    total += node.val\n                    node.val = total\n                    node = node.left\n\n        return roota\n```\n\n```Golang [sol2-Golang]\nfunc getSuccessor(node *TreeNode) *TreeNode {\n    succ := node.Right\n    for succ.Left != nil && succ.Left != node {\n        succ = succ.Left\n    }\n    return succ\n}\n\nfunc convertBST(root *TreeNode) *TreeNode {\n    sum := 0\n    node := root\n    for node != nil {\n        if node.Right == nil {\n            sum += node.Val\n            node.Val = sum\n            node = node.Left\n        } else {\n            succ := getSuccessor(node)\n            if succ.Left == nil {\n                succ.Left = node\n                node = node.Right\n            } else {\n                succ.Left = nil\n                sum += node.Val\n                node.Val = sum\n                node = node.Left\n            }\n        }\n    }\n    return root\n}\n```\n\n```C [sol2-C]\nstruct TreeNode* getSuccessor(struct TreeNode* node) {\n    struct TreeNode* succ = node->right;\n    while (succ->left != NULL && succ->left != node) {\n        succ = succ->left;\n    }\n    return succ;\n}\n\nstruct TreeNode* convertBST(struct TreeNode* root) {\n    int sum = 0;\n    struct TreeNode* node = root;\n\n    while (node != NULL) {\n        if (node->right == NULL) {\n            sum += node->val;\n            node->val = sum;\n            node = node->left;\n        } else {\n            struct TreeNode* succ = getSuccessor(node);\n            if (succ->left == NULL) {\n                succ->left = node;\n                node = node->right;\n            } else {\n                succ->left = NULL;\n                sum += node->val;\n                node->val = sum;\n                node = node->left;\n            }\n        }\n    }\n\n    return root;\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n- æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯äºŒå‰æœç´¢æ ‘çš„èŠ‚ç‚¹æ•°ã€‚æ²¡æœ‰å·¦å­æ ‘çš„èŠ‚ç‚¹åªè¢«è®¿é—®ä¸€æ¬¡ï¼Œæœ‰å·¦å­æ ‘çš„èŠ‚ç‚¹è¢«è®¿é—®ä¸¤æ¬¡ã€‚\n  \n- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚åªæ“ä½œå·²ç»å­˜åœ¨çš„æŒ‡é’ˆï¼ˆæ ‘çš„ç©ºé—²æŒ‡é’ˆï¼‰ï¼Œå› æ­¤åªéœ€è¦å¸¸æ•°çš„é¢å¤–ç©ºé—´ã€‚",
      "createdAt": "2020-09-20T16:08:54.622398+00:00",
      "hitCount": 46057,
      "identifier": "a7tqkf",
      "isEditorsPick": false,
      "isMostPopular": false,
      "isMyFavorite": false,
      "next": {
        "__typename": "BriefSolutionNode",
        "slug": "yi-tao-quan-fa-shua-diao-nge-bian-li-shu-de-wen-5",
        "title": "ä¸€å¥—æ‹³æ³•ğŸ‘Šåˆ·æ‰nä¸ªéå†æ ‘çš„é—®é¢˜"
      },
      "position": 1,
      "prev": null,
      "question": {
        "__typename": "QuestionNode",
        "questionTitleSlug": "convert-bst-to-greater-tree"
      },
      "reactionType": null,
      "reactionsV2": [
        {
          "__typename": "ReactionCountNode",
          "count": 56,
          "reactionType": "UPVOTE"
        },
        {
          "__typename": "ReactionCountNode",
          "count": 5,
          "reactionType": "AWESOME"
        }
      ],
      "rewardEnabled": null,
      "slug": "ba-er-cha-sou-suo-shu-zhuan-huan-wei-lei-jia-sh-14",
      "status": "PUBLISHED",
      "summary": "å‰è¨€ äºŒå‰æœç´¢æ ‘æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä¸‹åˆ—æ€§è´¨çš„äºŒå‰æ ‘ï¼š è‹¥å®ƒçš„å·¦å­æ ‘ä¸ç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› è‹¥å®ƒçš„å³å­æ ‘ä¸ç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹èŠ‚ç‚¹çš„å€¼ï¼› å®ƒçš„å·¦ã€å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æœç´¢æ ‘ã€‚ ç”±è¿™æ ·çš„æ€§è´¨æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒäºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†æ˜¯ä¸€ä¸ªå•è°ƒé€’å¢çš„æœ‰åºåºåˆ—ã€‚å¦‚æœæˆ‘ä»¬ååºåœ°ä¸­åºéå†è¯¥äºŒ",
      "sunk": false,
      "tags": [
        {
          "__typename": "CommonTagNode",
          "name": "Tree",
          "nameTranslated": "æ ‘",
          "slug": "tree",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Depth-First Search",
          "nameTranslated": "æ·±åº¦ä¼˜å…ˆæœç´¢",
          "slug": "depth-first-search",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Binary Search Tree",
          "nameTranslated": "äºŒå‰æœç´¢æ ‘",
          "slug": "binary-search-tree",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "C",
          "nameTranslated": "",
          "slug": "c",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "C++",
          "nameTranslated": "",
          "slug": "cpp",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Go",
          "nameTranslated": "",
          "slug": "golang",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Java",
          "nameTranslated": "",
          "slug": "java",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Python",
          "nameTranslated": "",
          "slug": "python",
          "tagType": "LANGUAGE"
        }
      ],
      "thumbnail": "",
      "title": "æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘",
      "topic": {
        "__typename": "TopicNode",
        "commentCount": 132,
        "id": 421616,
        "viewCount": 33420
      },
      "uuid": "a7tqkf",
      "videosInfo": []
    }
  }
}
