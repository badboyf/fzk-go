{
  "data": {
    "solutionArticle": {
      "__typename": "SolutionArticleNode",
      "author": {
        "__typename": "UserNode",
        "profile": {
          "__typename": "UserProfileNode",
          "realName": "åŠ›æ‰£å®˜æ–¹é¢˜è§£",
          "userAvatar": "https://assets.leetcode-cn.com/aliyun-lc-upload/users/leetcode-solution/avatar_1582018938.png",
          "userSlug": "leetcode-solution"
        },
        "username": "LeetCode-Solution"
      },
      "byLeetcode": true,
      "canEdit": false,
      "canEditReward": false,
      "canSee": true,
      "chargeType": "FREE",
      "content": "### ğŸ“º è§†é¢‘é¢˜è§£  \n![42. æ¥é›¨æ°´.mp4](21f6ec58-ab28-4e14-9fd0-bcd7d68f35b1)\n\n### ğŸ“– æ–‡å­—é¢˜è§£\n#### æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’\n\nå¯¹äºä¸‹æ ‡ $i$ï¼Œä¸‹é›¨åæ°´èƒ½åˆ°è¾¾çš„æœ€å¤§é«˜åº¦ç­‰äºä¸‹æ ‡ $i$ ä¸¤è¾¹çš„æœ€å¤§é«˜åº¦çš„æœ€å°å€¼ï¼Œä¸‹æ ‡ $i$ å¤„èƒ½æ¥çš„é›¨æ°´é‡ç­‰äºä¸‹æ ‡ $i$ å¤„çš„æ°´èƒ½åˆ°è¾¾çš„æœ€å¤§é«˜åº¦å‡å» $\\textit{height}[i]$ã€‚\n\næœ´ç´ çš„åšæ³•æ˜¯å¯¹äºæ•°ç»„ $\\textit{height}$ ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«å‘å·¦å’Œå‘å³æ‰«æå¹¶è®°å½•å·¦è¾¹å’Œå³è¾¹çš„æœ€å¤§é«˜åº¦ï¼Œç„¶åè®¡ç®—æ¯ä¸ªä¸‹æ ‡ä½ç½®èƒ½æ¥çš„é›¨æ°´é‡ã€‚å‡è®¾æ•°ç»„ $\\textit{height}$ çš„é•¿åº¦ä¸º $n$ï¼Œè¯¥åšæ³•éœ€è¦å¯¹æ¯ä¸ªä¸‹æ ‡ä½ç½®ä½¿ç”¨ $O(n)$ çš„æ—¶é—´å‘ä¸¤è¾¹æ‰«æå¹¶å¾—åˆ°æœ€å¤§é«˜åº¦ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2)$ã€‚\n\nä¸Šè¿°åšæ³•çš„æ—¶é—´å¤æ‚åº¦è¾ƒé«˜æ˜¯å› ä¸ºéœ€è¦å¯¹æ¯ä¸ªä¸‹æ ‡ä½ç½®éƒ½å‘ä¸¤è¾¹æ‰«æã€‚å¦‚æœå·²ç»çŸ¥é“æ¯ä¸ªä½ç½®ä¸¤è¾¹çš„æœ€å¤§é«˜åº¦ï¼Œåˆ™å¯ä»¥åœ¨ $O(n)$ çš„æ—¶é—´å†…å¾—åˆ°èƒ½æ¥çš„é›¨æ°´æ€»é‡ã€‚ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨ $O(n)$ çš„æ—¶é—´å†…é¢„å¤„ç†å¾—åˆ°æ¯ä¸ªä½ç½®ä¸¤è¾¹çš„æœ€å¤§é«˜åº¦ã€‚\n\nåˆ›å»ºä¸¤ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ã€‚å¯¹äº $0 \\le i<n$ï¼Œ$\\textit{leftMax}[i]$ è¡¨ç¤ºä¸‹æ ‡ $i$ åŠå…¶å·¦è¾¹çš„ä½ç½®ä¸­ï¼Œ$\\textit{height}$ çš„æœ€å¤§é«˜åº¦ï¼Œ$\\textit{rightMax}[i]$ è¡¨ç¤ºä¸‹æ ‡ $i$ åŠå…¶å³è¾¹çš„ä½ç½®ä¸­ï¼Œ$\\textit{height}$ çš„æœ€å¤§é«˜åº¦ã€‚\n\næ˜¾ç„¶ï¼Œ$\\textit{leftMax}[0]=\\textit{height}[0]$ï¼Œ$\\textit{rightMax}[n-1]=\\textit{height}[n-1]$ã€‚ä¸¤ä¸ªæ•°ç»„çš„å…¶ä½™å…ƒç´ çš„è®¡ç®—å¦‚ä¸‹ï¼š\n\n- å½“ $1 \\le i \\le n-1$ æ—¶ï¼Œ$\\textit{leftMax}[i]=\\max(\\textit{leftMax}[i-1], \\textit{height}[i])$ï¼›\n\n- å½“ $0 \\le i \\le n-2$ æ—¶ï¼Œ$\\textit{rightMax}[i]=\\max(\\textit{rightMax}[i+1], \\textit{height}[i])$ã€‚\n\nå› æ­¤å¯ä»¥æ­£å‘éå†æ•°ç»„ $\\textit{height}$ å¾—åˆ°æ•°ç»„ $\\textit{leftMax}$ çš„æ¯ä¸ªå…ƒç´ å€¼ï¼Œåå‘éå†æ•°ç»„ $\\textit{height}$ å¾—åˆ°æ•°ç»„ $\\textit{rightMax}$ çš„æ¯ä¸ªå…ƒç´ å€¼ã€‚\n\nåœ¨å¾—åˆ°æ•°ç»„ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ çš„æ¯ä¸ªå…ƒç´ å€¼ä¹‹åï¼Œå¯¹äº $0 \\le i<n$ï¼Œä¸‹æ ‡ $i$ å¤„èƒ½æ¥çš„é›¨æ°´é‡ç­‰äº $\\min(\\textit{leftMax}[i],\\textit{rightMax}[i])-\\textit{height}[i]$ã€‚éå†æ¯ä¸ªä¸‹æ ‡ä½ç½®å³å¯å¾—åˆ°èƒ½æ¥çš„é›¨æ°´æ€»é‡ã€‚\n\nåŠ¨æ€è§„åˆ’åšæ³•å¯ä»¥ç”±ä¸‹å›¾ä½“ç°ã€‚\n\n![fig1](https://assets.leetcode-cn.com/solution-static/42/1.png)\n\n```Java [sol1-Java]\nclass Solution {\n    public int trap(int[] height) {\n        int n = height.length;\n        if (n == 0) {\n            return 0;\n        }\n\n        int[] leftMax = new int[n];\n        leftMax[0] = height[0];\n        for (int i = 1; i < n; ++i) {\n            leftMax[i] = Math.max(leftMax[i - 1], height[i]);\n        }\n\n        int[] rightMax = new int[n];\n        rightMax[n - 1] = height[n - 1];\n        for (int i = n - 2; i >= 0; --i) {\n            rightMax[i] = Math.max(rightMax[i + 1], height[i]);\n        }\n\n        int ans = 0;\n        for (int i = 0; i < n; ++i) {\n            ans += Math.min(leftMax[i], rightMax[i]) - height[i];\n        }\n        return ans;\n    }\n}\n```\n\n```go [sol1-Golang]\nfunc trap(height []int) (ans int) {\n    n := len(height)\n    if n == 0 {\n        return\n    }\n\n    leftMax := make([]int, n)\n    leftMax[0] = height[0]\n    for i := 1; i < n; i++ {\n        leftMax[i] = max(leftMax[i-1], height[i])\n    }\n\n    rightMax := make([]int, n)\n    rightMax[n-1] = height[n-1]\n    for i := n - 2; i >= 0; i-- {\n        rightMax[i] = max(rightMax[i+1], height[i])\n    }\n\n    for i, h := range height {\n        ans += min(leftMax[i], rightMax[i]) - h\n    }\n    return\n}\n\nfunc min(a, b int) int {\n    if a < b {\n        return a\n    }\n    return b\n}\n\nfunc max(a, b int) int {\n    if a > b {\n        return a\n    }\n    return b\n}\n```\n\n```JavaScript [sol1-JavaScript]\nvar trap = function(height) {\n    const n = height.length;\n    if (n == 0) {\n        return 0;\n    }\n\n    const leftMax = new Array(n).fill(0);\n    leftMax[0] = height[0];\n    for (let i = 1; i < n; ++i) {\n        leftMax[i] = Math.max(leftMax[i - 1], height[i]);\n    }\n\n    const rightMax = new Array(n).fill(0);\n    rightMax[n - 1] = height[n - 1];\n    for (let i = n - 2; i >= 0; --i) {\n        rightMax[i] = Math.max(rightMax[i + 1], height[i]);\n    }\n\n    let ans = 0;\n    for (let i = 0; i < n; ++i) {\n        ans += Math.min(leftMax[i], rightMax[i]) - height[i];\n    }\n    return ans;\n};\n```\n\n```Python [sol1-Python3]\nclass Solution:\n    def trap(self, height: List[int]) -> int:\n        if not height:\n            return 0\n        \n        n = len(height)\n        leftMax = [height[0]] + [0] * (n - 1)\n        for i in range(1, n):\n            leftMax[i] = max(leftMax[i - 1], height[i])\n\n        rightMax = [0] * (n - 1) + [height[n - 1]]\n        for i in range(n - 2, -1, -1):\n            rightMax[i] = max(rightMax[i + 1], height[i])\n\n        ans = sum(min(leftMax[i], rightMax[i]) - height[i] for i in range(n))\n        return ans\n```\n\n```C++ [sol1-C++]\nclass Solution {\npublic:\n    int trap(vector<int>& height) {\n        int n = height.size();\n        if (n == 0) {\n            return 0;\n        }\n        vector<int> leftMax(n);\n        leftMax[0] = height[0];\n        for (int i = 1; i < n; ++i) {\n            leftMax[i] = max(leftMax[i - 1], height[i]);\n        }\n\n        vector<int> rightMax(n);\n        rightMax[n - 1] = height[n - 1];\n        for (int i = n - 2; i >= 0; --i) {\n            rightMax[i] = max(rightMax[i + 1], height[i]);\n        }\n\n        int ans = 0;\n        for (int i = 0; i < n; ++i) {\n            ans += min(leftMax[i], rightMax[i]) - height[i];\n        }\n        return ans;\n    }\n};\n```\n\n```C [sol1-C]\nint trap(int* height, int heightSize) {\n    int n = heightSize;\n    if (n == 0) {\n        return 0;\n    }\n    int leftMax[n];\n    memset(leftMax, 0, sizeof(leftMax));\n    leftMax[0] = height[0];\n    for (int i = 1; i < n; ++i) {\n        leftMax[i] = fmax(leftMax[i - 1], height[i]);\n    }\n\n    int rightMax[n];\n    memset(rightMax, 0, sizeof(rightMax));\n    rightMax[n - 1] = height[n - 1];\n    for (int i = n - 2; i >= 0; --i) {\n        rightMax[i] = fmax(rightMax[i + 1], height[i]);\n    }\n\n    int ans = 0;\n    for (int i = 0; i < n; ++i) {\n        ans += fmin(leftMax[i], rightMax[i]) - height[i];\n    }\n    return ans;\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n- æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„ $\\textit{height}$ çš„é•¿åº¦ã€‚è®¡ç®—æ•°ç»„ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ çš„å…ƒç´ å€¼å„éœ€è¦éå†æ•°ç»„ $\\textit{height}$ ä¸€æ¬¡ï¼Œè®¡ç®—èƒ½æ¥çš„é›¨æ°´æ€»é‡è¿˜éœ€è¦éå†ä¸€æ¬¡ã€‚\n\n- ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„ $\\textit{height}$ çš„é•¿åº¦ã€‚éœ€è¦åˆ›å»ºä¸¤ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ã€‚\n\n#### æ–¹æ³•äºŒï¼šå•è°ƒæ ˆ\n\né™¤äº†è®¡ç®—å¹¶å­˜å‚¨æ¯ä¸ªä½ç½®ä¸¤è¾¹çš„æœ€å¤§é«˜åº¦ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨å•è°ƒæ ˆè®¡ç®—èƒ½æ¥çš„é›¨æ°´æ€»é‡ã€‚\n\nç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆï¼Œå•è°ƒæ ˆå­˜å‚¨çš„æ˜¯ä¸‹æ ‡ï¼Œæ»¡è¶³ä»æ ˆåº•åˆ°æ ˆé¡¶çš„ä¸‹æ ‡å¯¹åº”çš„æ•°ç»„ $\\textit{height}$ ä¸­çš„å…ƒç´ é€’å‡ã€‚\n\nä»å·¦åˆ°å³éå†æ•°ç»„ï¼Œéå†åˆ°ä¸‹æ ‡ $i$ æ—¶ï¼Œå¦‚æœæ ˆå†…è‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œè®°æ ˆé¡¶å…ƒç´ ä¸º $\\textit{top}$ï¼Œ$\\textit{top}$ çš„ä¸‹é¢ä¸€ä¸ªå…ƒç´ æ˜¯ $\\textit{left}$ï¼Œåˆ™ä¸€å®šæœ‰ $\\textit{height}[\\textit{left}] \\ge \\textit{height}[\\textit{top}]$ã€‚å¦‚æœ $\\textit{height}[i]>\\textit{height}[\\textit{top}]$ï¼Œåˆ™å¾—åˆ°ä¸€ä¸ªå¯ä»¥æ¥é›¨æ°´çš„åŒºåŸŸï¼Œè¯¥åŒºåŸŸçš„å®½åº¦æ˜¯ $i-\\textit{left}-1$ï¼Œé«˜åº¦æ˜¯ $\\min(\\textit{height}[\\textit{left}],\\textit{height}[i])-\\textit{height}[\\textit{top}]$ï¼Œæ ¹æ®å®½åº¦å’Œé«˜åº¦å³å¯è®¡ç®—å¾—åˆ°è¯¥åŒºåŸŸèƒ½æ¥çš„é›¨æ°´é‡ã€‚\n\nä¸ºäº†å¾—åˆ° $\\textit{left}$ï¼Œéœ€è¦å°† $\\textit{top}$ å‡ºæ ˆã€‚åœ¨å¯¹ $\\textit{top}$ è®¡ç®—èƒ½æ¥çš„é›¨æ°´é‡ä¹‹åï¼Œ$\\textit{left}$ å˜æˆæ–°çš„ $\\textit{top}$ï¼Œé‡å¤ä¸Šè¿°æ“ä½œï¼Œç›´åˆ°æ ˆå˜ä¸ºç©ºï¼Œæˆ–è€…æ ˆé¡¶ä¸‹æ ‡å¯¹åº”çš„ $\\textit{height}$ ä¸­çš„å…ƒç´ å¤§äºæˆ–ç­‰äº $\\textit{height}[i]$ã€‚\n\nåœ¨å¯¹ä¸‹æ ‡ $i$ å¤„è®¡ç®—èƒ½æ¥çš„é›¨æ°´é‡ä¹‹åï¼Œå°† $i$ å…¥æ ˆï¼Œç»§ç»­éå†åé¢çš„ä¸‹æ ‡ï¼Œè®¡ç®—èƒ½æ¥çš„é›¨æ°´é‡ã€‚éå†ç»“æŸä¹‹åå³å¯å¾—åˆ°èƒ½æ¥çš„é›¨æ°´æ€»é‡ã€‚\n\nä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­ $\\textit{height}=[0,1,0,2,1,0,1,3,2,1,2,1]$ æ¥å¸®åŠ©è¯»è€…ç†è§£å•è°ƒæ ˆçš„åšæ³•ã€‚\n\n<![f1](https://assets.leetcode-cn.com/solution-static/42/f1.png),![f2](https://assets.leetcode-cn.com/solution-static/42/f2.png),![f3](https://assets.leetcode-cn.com/solution-static/42/f3.png),![f4](https://assets.leetcode-cn.com/solution-static/42/f4.png),![f5](https://assets.leetcode-cn.com/solution-static/42/f5.png),![f6](https://assets.leetcode-cn.com/solution-static/42/f6.png),![f7](https://assets.leetcode-cn.com/solution-static/42/f7.png),![f8](https://assets.leetcode-cn.com/solution-static/42/f8.png),![f9](https://assets.leetcode-cn.com/solution-static/42/f9.png),![f10](https://assets.leetcode-cn.com/solution-static/42/f10.png),![f11](https://assets.leetcode-cn.com/solution-static/42/f11.png),![f12](https://assets.leetcode-cn.com/solution-static/42/f12.png),![f13](https://assets.leetcode-cn.com/solution-static/42/f13.png),![f14](https://assets.leetcode-cn.com/solution-static/42/f14.png),![f15](https://assets.leetcode-cn.com/solution-static/42/f15.png),![f16](https://assets.leetcode-cn.com/solution-static/42/f16.png),![f17](https://assets.leetcode-cn.com/solution-static/42/f17.png),![f18](https://assets.leetcode-cn.com/solution-static/42/f18.png),![f19](https://assets.leetcode-cn.com/solution-static/42/f19.png),![f20](https://assets.leetcode-cn.com/solution-static/42/f20.png),![f21](https://assets.leetcode-cn.com/solution-static/42/f21.png)>\n\n```Java [sol2-Java]\nclass Solution {\n    public int trap(int[] height) {\n        int ans = 0;\n        Deque<Integer> stack = new LinkedList<Integer>();\n        int n = height.length;\n        for (int i = 0; i < n; ++i) {\n            while (!stack.isEmpty() && height[i] > height[stack.peek()]) {\n                int top = stack.pop();\n                if (stack.isEmpty()) {\n                    break;\n                }\n                int left = stack.peek();\n                int currWidth = i - left - 1;\n                int currHeight = Math.min(height[left], height[i]) - height[top];\n                ans += currWidth * currHeight;\n            }\n            stack.push(i);\n        }\n        return ans;\n    }\n}\n```\n\n```go [sol2-Golang]\nfunc trap(height []int) (ans int) {\n    stack := []int{}\n    for i, h := range height {\n        for len(stack) > 0 && h > height[stack[len(stack)-1]] {\n            top := stack[len(stack)-1]\n            stack = stack[:len(stack)-1]\n            if len(stack) == 0 {\n                break\n            }\n            left := stack[len(stack)-1]\n            curWidth := i - left - 1\n            curHeight := min(height[left], h) - height[top]\n            ans += curWidth * curHeight\n        }\n        stack = append(stack, i)\n    }\n    return\n}\n\nfunc min(a, b int) int {\n    if a < b {\n        return a\n    }\n    return b\n}\n```\n\n```JavaScript [sol2-JavaScript]\nvar trap = function(height) {\n    let ans = 0;\n    const stack = [];\n    const n = height.length;\n    for (let i = 0; i < n; ++i) {\n        while (stack.length && height[i] > height[stack[stack.length - 1]]) {\n            const top = stack.pop();\n            if (!stack.length) {\n                break;\n            }\n            const left = stack[stack.length - 1];\n            const currWidth = i - left - 1;\n            const currHeight = Math.min(height[left], height[i]) - height[top];\n            ans += currWidth * currHeight;\n        }\n        stack.push(i);\n    }\n    return ans;\n};\n```\n\n```Python [sol2-Python3]\nclass Solution:\n    def trap(self, height: List[int]) -> int:\n        ans = 0\n        stack = list()\n        n = len(height)\n        \n        for i, h in enumerate(height):\n            while stack and h > height[stack[-1]]:\n                top = stack.pop()\n                if not stack:\n                    break\n                left = stack[-1]\n                currWidth = i - left - 1\n                currHeight = min(height[left], height[i]) - height[top]\n                ans += currWidth * currHeight\n            stack.append(i)\n        \n        return ans\n```\n\n```C++ [sol2-C++]\nclass Solution {\npublic:\n    int trap(vector<int>& height) {\n        int ans = 0;\n        stack<int> stk;\n        int n = height.size();\n        for (int i = 0; i < n; ++i) {\n            while (!stk.empty() && height[i] > height[stk.top()]) {\n                int top = stk.top();\n                stk.pop();\n                if (stk.empty()) {\n                    break;\n                }\n                int left = stk.top();\n                int currWidth = i - left - 1;\n                int currHeight = min(height[left], height[i]) - height[top];\n                ans += currWidth * currHeight;\n            }\n            stk.push(i);\n        }\n        return ans;\n    }\n};\n```\n\n```C [sol2-C]\nint trap(int* height, int heightSize) {\n    int n = heightSize;\n    if (n == 0) {\n        return 0;\n    }\n    int ans = 0;\n    int stk[n], top = 0;\n    for (int i = 0; i < n; ++i) {\n        while (top && height[i] > height[stk[top - 1]]) {\n            int stk_top = stk[--top];\n            if (!top) {\n                break;\n            }\n            int left = stk[top - 1];\n            int currWidth = i - left - 1;\n            int currHeight = fmin(height[left], height[i]) - height[stk_top];\n            ans += currWidth * currHeight;\n        }\n        stk[top++] = i;\n    }\n    return ans;\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n- æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„ $\\textit{height}$ çš„é•¿åº¦ã€‚ä» $0$ åˆ° $n-1$ çš„æ¯ä¸ªä¸‹æ ‡æœ€å¤šåªä¼šå…¥æ ˆå’Œå‡ºæ ˆå„ä¸€æ¬¡ã€‚\n\n- ç©ºé—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„ $\\textit{height}$ çš„é•¿åº¦ã€‚ç©ºé—´å¤æ‚åº¦ä¸»è¦å–å†³äºæ ˆç©ºé—´ï¼Œæ ˆçš„å¤§å°ä¸ä¼šè¶…è¿‡ $n$ã€‚\n\n#### æ–¹æ³•ä¸‰ï¼šåŒæŒ‡é’ˆ\n\nåŠ¨æ€è§„åˆ’çš„åšæ³•ä¸­ï¼Œéœ€è¦ç»´æŠ¤ä¸¤ä¸ªæ•°ç»„ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦æ˜¯ $O(n)$ã€‚æ˜¯å¦å¯ä»¥å°†ç©ºé—´å¤æ‚åº¦é™åˆ° $O(1)$ï¼Ÿ\n\næ³¨æ„åˆ°ä¸‹æ ‡ $i$ å¤„èƒ½æ¥çš„é›¨æ°´é‡ç”± $\\textit{leftMax}[i]$ å’Œ $\\textit{rightMax}[i]$ ä¸­çš„æœ€å°å€¼å†³å®šã€‚ç”±äºæ•°ç»„ $\\textit{leftMax}$ æ˜¯ä»å·¦å¾€å³è®¡ç®—ï¼Œæ•°ç»„ $\\textit{rightMax}$ æ˜¯ä»å³å¾€å·¦è®¡ç®—ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆå’Œä¸¤ä¸ªå˜é‡ä»£æ›¿ä¸¤ä¸ªæ•°ç»„ã€‚\n\nç»´æŠ¤ä¸¤ä¸ªæŒ‡é’ˆ $\\textit{left}$ å’Œ $\\textit{right}$ï¼Œä»¥åŠä¸¤ä¸ªå˜é‡ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ï¼Œåˆå§‹æ—¶ $\\textit{left}=0,\\textit{right}=n-1,\\textit{leftMax}=0,\\textit{rightMax}=0$ã€‚æŒ‡é’ˆ $\\textit{left}$ åªä¼šå‘å³ç§»åŠ¨ï¼ŒæŒ‡é’ˆ $\\textit{right}$ åªä¼šå‘å·¦ç§»åŠ¨ï¼Œåœ¨ç§»åŠ¨æŒ‡é’ˆçš„è¿‡ç¨‹ä¸­ç»´æŠ¤ä¸¤ä¸ªå˜é‡ $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ çš„å€¼ã€‚\n\nå½“ä¸¤ä¸ªæŒ‡é’ˆæ²¡æœ‰ç›¸é‡æ—¶ï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š\n\n- ä½¿ç”¨ $\\textit{height}[\\textit{left}]$ å’Œ $\\textit{height}[\\textit{right}]$ çš„å€¼æ›´æ–° $\\textit{leftMax}$ å’Œ $\\textit{rightMax}$ çš„å€¼ï¼›\n\n- å¦‚æœ $\\textit{height}[\\textit{left}]<\\textit{height}[\\textit{right}]$ï¼Œåˆ™å¿…æœ‰ $\\textit{leftMax}<\\textit{rightMax}$ï¼Œä¸‹æ ‡ $\\textit{left}$ å¤„èƒ½æ¥çš„é›¨æ°´é‡ç­‰äº $\\textit{leftMax}-\\textit{height}[\\textit{left}]$ï¼Œå°†ä¸‹æ ‡ $\\textit{left}$ å¤„èƒ½æ¥çš„é›¨æ°´é‡åŠ åˆ°èƒ½æ¥çš„é›¨æ°´æ€»é‡ï¼Œç„¶åå°† $\\textit{left}$ åŠ  $1$ï¼ˆå³å‘å³ç§»åŠ¨ä¸€ä½ï¼‰ï¼›\n\n- å¦‚æœ $\\textit{height}[\\textit{left}] \\ge \\textit{height}[\\textit{right}]$ï¼Œåˆ™å¿…æœ‰ $\\textit{leftMax} \\ge \\textit{rightMax}$ï¼Œä¸‹æ ‡ $\\textit{right}$ å¤„èƒ½æ¥çš„é›¨æ°´é‡ç­‰äº $\\textit{rightMax}-\\textit{height}[\\textit{right}]$ï¼Œå°†ä¸‹æ ‡ $\\textit{right}$ å¤„èƒ½æ¥çš„é›¨æ°´é‡åŠ åˆ°èƒ½æ¥çš„é›¨æ°´æ€»é‡ï¼Œç„¶åå°† $\\textit{right}$ å‡ $1$ï¼ˆå³å‘å·¦ç§»åŠ¨ä¸€ä½ï¼‰ã€‚\n\nå½“ä¸¤ä¸ªæŒ‡é’ˆç›¸é‡æ—¶ï¼Œå³å¯å¾—åˆ°èƒ½æ¥çš„é›¨æ°´æ€»é‡ã€‚\n\nä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­ $\\textit{height}=[0,1,0,2,1,0,1,3,2,1,2,1]$ æ¥å¸®åŠ©è¯»è€…ç†è§£åŒæŒ‡é’ˆçš„åšæ³•ã€‚\n\n<![p1](https://assets.leetcode-cn.com/solution-static/42/p1.png),![p2](https://assets.leetcode-cn.com/solution-static/42/p2.png),![p3](https://assets.leetcode-cn.com/solution-static/42/p3.png),![p4](https://assets.leetcode-cn.com/solution-static/42/p4.png),![p5](https://assets.leetcode-cn.com/solution-static/42/p5.png),![p6](https://assets.leetcode-cn.com/solution-static/42/p6.png),![p7](https://assets.leetcode-cn.com/solution-static/42/p7.png),![p8](https://assets.leetcode-cn.com/solution-static/42/p8.png),![p9](https://assets.leetcode-cn.com/solution-static/42/p9.png),![p10](https://assets.leetcode-cn.com/solution-static/42/p10.png),![p11](https://assets.leetcode-cn.com/solution-static/42/p11.png),![p12](https://assets.leetcode-cn.com/solution-static/42/p12.png)>\n\n```Java [sol3-Java]\nclass Solution {\n    public int trap(int[] height) {\n        int ans = 0;\n        int left = 0, right = height.length - 1;\n        int leftMax = 0, rightMax = 0;\n        while (left < right) {\n            leftMax = Math.max(leftMax, height[left]);\n            rightMax = Math.max(rightMax, height[right]);\n            if (height[left] < height[right]) {\n                ans += leftMax - height[left];\n                ++left;\n            } else {\n                ans += rightMax - height[right];\n                --right;\n            }\n        }\n        return ans;\n    }\n}\n```\n\n```go [sol3-Golang]\nfunc trap(height []int) (ans int) {\n    left, right := 0, len(height)-1\n    leftMax, rightMax := 0, 0\n    for left < right {\n        leftMax = max(leftMax, height[left])\n        rightMax = max(rightMax, height[right])\n        if height[left] < height[right] {\n            ans += leftMax - height[left]\n            left++\n        } else {\n            ans += rightMax - height[right]\n            right--\n        }\n    }\n    return\n}\n\nfunc max(a, b int) int {\n    if a > b {\n        return a\n    }\n    return b\n}\n```\n\n```JavaScript [sol3-JavaScript]\nvar trap = function(height) {\n    let ans = 0;\n    let left = 0, right = height.length - 1;\n    let leftMax = 0, rightMax = 0;\n    while (left < right) {\n        leftMax = Math.max(leftMax, height[left]);\n        rightMax = Math.max(rightMax, height[right]);\n        if (height[left] < height[right]) {\n            ans += leftMax - height[left];\n            ++left;\n        } else {\n            ans += rightMax - height[right];\n            --right;\n        }\n    }\n    return ans;\n};\n```\n\n```Python [sol3-Python3]\nclass Solution:\n    def trap(self, height: List[int]) -> int:\n        ans = 0\n        left, right = 0, len(height) - 1\n        leftMax = rightMax = 0\n\n        while left < right:\n            leftMax = max(leftMax, height[left])\n            rightMax = max(rightMax, height[right])\n            if height[left] < height[right]:\n                ans += leftMax - height[left]\n                left += 1\n            else:\n                ans += rightMax - height[right]\n                right -= 1\n        \n        return ans\n```\n\n```C++ [sol3-C++]\nclass Solution {\npublic:\n    int trap(vector<int>& height) {\n        int ans = 0;\n        int left = 0, right = height.size() - 1;\n        int leftMax = 0, rightMax = 0;\n        while (left < right) {\n            leftMax = max(leftMax, height[left]);\n            rightMax = max(rightMax, height[right]);\n            if (height[left] < height[right]) {\n                ans += leftMax - height[left];\n                ++left;\n            } else {\n                ans += rightMax - height[right];\n                --right;\n            }\n        }\n        return ans;\n    }\n};\n```\n\n```C [sol3-C]\nint trap(int* height, int heightSize) {\n    int ans = 0;\n    int left = 0, right = heightSize - 1;\n    int leftMax = 0, rightMax = 0;\n    while (left < right) {\n        leftMax = fmax(leftMax, height[left]);\n        rightMax = fmax(rightMax, height[right]);\n        if (height[left] < height[right]) {\n            ans += leftMax - height[left];\n            ++left;\n        } else {\n            ans += rightMax - height[right];\n            --right;\n        }\n    }\n    return ans;\n}\n```\n\n**å¤æ‚åº¦åˆ†æ**\n\n- æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ï¼Œå…¶ä¸­ $n$ æ˜¯æ•°ç»„ $\\textit{height}$ çš„é•¿åº¦ã€‚ä¸¤ä¸ªæŒ‡é’ˆçš„ç§»åŠ¨æ€»æ¬¡æ•°ä¸è¶…è¿‡ $n$ã€‚\n\n- ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ã€‚åªéœ€è¦ä½¿ç”¨å¸¸æ•°çš„é¢å¤–ç©ºé—´ã€‚",
      "createdAt": "2021-03-31T12:56:21.873482+00:00",
      "hitCount": 140379,
      "identifier": "kuTwCm",
      "isEditorsPick": false,
      "isMostPopular": false,
      "isMyFavorite": false,
      "next": {
        "__typename": "BriefSolutionNode",
        "slug": "jie-yu-shui-by-leetcode",
        "title": "æ¥é›¨æ°´"
      },
      "position": 1,
      "prev": null,
      "question": {
        "__typename": "QuestionNode",
        "questionTitleSlug": "trapping-rain-water"
      },
      "reactionType": null,
      "reactionsV2": [
        {
          "__typename": "ReactionCountNode",
          "count": 182,
          "reactionType": "UPVOTE"
        },
        {
          "__typename": "ReactionCountNode",
          "count": 10,
          "reactionType": "AWESOME"
        },
        {
          "__typename": "ReactionCountNode",
          "count": 4,
          "reactionType": "CONFUSED"
        },
        {
          "__typename": "ReactionCountNode",
          "count": 0,
          "reactionType": "THUMBS_DOWN"
        }
      ],
      "rewardEnabled": null,
      "slug": "jie-yu-shui-by-leetcode-solution-tuvc",
      "status": "PUBLISHED",
      "summary": "ğŸ“º è§†é¢‘é¢˜è§£ ğŸ“– æ–‡å­—é¢˜è§£ æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’ å¯¹äºä¸‹æ ‡ $i$ï¼Œä¸‹é›¨åæ°´èƒ½åˆ°è¾¾çš„æœ€å¤§é«˜åº¦ç­‰äºä¸‹æ ‡ $i$ ä¸¤è¾¹çš„æœ€å¤§é«˜åº¦çš„æœ€å°å€¼ï¼Œä¸‹æ ‡ $i$ å¤„èƒ½æ¥çš„é›¨æ°´é‡ç­‰äºä¸‹æ ‡ $i$ å¤„çš„æ°´èƒ½åˆ°è¾¾çš„æœ€å¤§é«˜åº¦å‡å» $\\textit{height}[i]$ã€‚ æœ´ç´ çš„åšæ³•æ˜¯å¯¹äºæ•°ç»„ $\\textit{height}$ ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œ",
      "sunk": false,
      "tags": [
        {
          "__typename": "CommonTagNode",
          "name": "Stack",
          "nameTranslated": "æ ˆ",
          "slug": "stack",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Array",
          "nameTranslated": "æ•°ç»„",
          "slug": "array",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Two Pointers",
          "nameTranslated": "åŒæŒ‡é’ˆ",
          "slug": "two-pointers",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Dynamic Programming",
          "nameTranslated": "åŠ¨æ€è§„åˆ’",
          "slug": "dynamic-programming",
          "tagType": "TOPIC"
        },
        {
          "__typename": "CommonTagNode",
          "name": "C",
          "nameTranslated": "",
          "slug": "c",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "C++",
          "nameTranslated": "",
          "slug": "cpp",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Go",
          "nameTranslated": "",
          "slug": "golang",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Java",
          "nameTranslated": "",
          "slug": "java",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "JavaScript",
          "nameTranslated": "",
          "slug": "javascript",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Python",
          "nameTranslated": "",
          "slug": "python",
          "tagType": "LANGUAGE"
        },
        {
          "__typename": "CommonTagNode",
          "name": "Monotonic Stack",
          "nameTranslated": "å•è°ƒæ ˆ",
          "slug": "monotonic-stack",
          "tagType": "TOPIC"
        }
      ],
      "thumbnail": "",
      "title": "æ¥é›¨æ°´",
      "topic": {
        "__typename": "TopicNode",
        "commentCount": 129,
        "id": 692342,
        "viewCount": 88181
      },
      "uuid": "kuTwCm",
      "videosInfo": []
    }
  }
}
